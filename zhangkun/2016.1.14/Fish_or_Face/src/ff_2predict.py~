import mxnet as mx
import numpy

model = mx.model.FeedForward.load(prefix = 'ff2',epoch = 20,ctx = mx.gpu(0))
val = mx.io.ImageRecordIter(
    path_imgrec = data_dir + path,
    data_shape  = (3,28,28),
    batch_size  = 1,)

result = model.predict(X = val)

a = result.shape[0]
ff_val = open(data_dir+filename,'r')
ff_val1 = open(data_dir+"test_result.lst",'w')
for b in range(a):
    line=ff_val.readline()
    if result[b][0] > result[b][1] :
        predict = '0----fish'
    else :
        predict = '1----face'
    print b
    new_line = line.strip('\n') + '\t'+predict+'\n'
    ff_val1.writelines(new_line)
    
ff_val.close()
ff_val1.close()
